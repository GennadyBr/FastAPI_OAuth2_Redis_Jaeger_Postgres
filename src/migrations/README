Generic single-database configuration.


1)
запуск
#
docker compose up --build
#


2)
Для накатывания миграций, если файла alembic.ini еще нет, нужно запустить в терминале команду:
#
/Auth_sprint_1/src/alembic init migrations
#
после этого будет создана папка с миграциями и конфигурационный файл алембика

3)
В alembic.ini надо задать адрес базы данных, в которую будем катать миграции.
#
sqlalchemy.url = postgresql://postgres:postgres@0.0.0.0:5432/postgres
#
postgresql - это драйвер подключения что бы алхимия подключалась
postgres:postgres - это логин и пароль

4)
Дальше идем в папку миграции и открываем файл env.py, там вносим изменения в блок
#
from myapp import mymodel
# меняем на
from db.users import Base
#
target_metadata = Base.metadata
#

5)
Дальше вводим:
#
/Auth_sprint_1/src/alembic revision --autogenerate -m "create table user"
#
Будет создана миграция

6)
Дальше вводим:
#
/Auth_sprint_1/src/alembic upgrade heads
#
будут обновлены заголовки таблицы